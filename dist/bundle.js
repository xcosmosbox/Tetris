(()=>{"use strict";var e={426:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(81),r=n.n(o),i=n(645),s=n.n(i)()(r());s.push([e.id,":root {\n  background-color: rgb(161, 134, 98);\n  padding: 2em;\n  padding-top: 4em;\n}\n\nBODY,\nH2,\nH3,\nH4,\nH5,\nH6,\nTH,\nTD {\n  font-family: arial, helvetica, sans-serif;\n}\n\nbody {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n\nH1 {\n  font-size: 3em;\n  font-family: arial, helvetica, sans-serif;\n  font-weight: bolder;\n  background-color: rgb(255, 216, 165);\n  border-radius: 0.05em;\n  padding: 0.1em 0.1em 0.1em 0.1em;\n  box-shadow: 0em 0em 0.15em rgb(107, 83, 50);\n  text-shadow: 0em 0em 1px rgb(107, 83, 50);\n}\n\n.flex {\n  display: flex;\n  row-gap: 1em;\n  column-gap: 1em;\n}\n\n.col {\n  flex-direction: column;\n}\n\n.row {\n  flex-direction: row;\n}\n\nmain {\n  background-color: rgb(255, 216, 165);\n  border-radius: 0.25em;\n  box-shadow: 0em 0em 0.5em rgb(107, 83, 50);\n  flex-wrap: wrap;\n  padding: 1em;\n  max-width: 400px;\n}\n\nsvg {\n  border-radius: 0.1em;\n  border: 5px solid rgb(65, 54, 40);\n}\n\nsvg rect {\n  stroke: black;\n  stroke-width: 2px;\n}\n\n.button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: white;\n  width: 151px;\n  height: 48px;\n  border: 2px solid black;\n  margin-top: 1em;\n  border-radius: 5px;\n  font-size: 0.8em;\n  font-weight: bolder;\n  text-align: center;\n  cursor: pointer;\n}\n\n.button:hover {\n  background-color: rgb(240, 240, 240); \n}\n\n.button span {\n  color: red;\n}\n\n\n#svgCanvas {\n  background-color: rgb(183, 151, 110);\n}\n\n#svgPreview {\n  background-color: rgb(218, 180, 131);\n}\n\n#info {\n  width: 160px;\n  margin-top: 1em;\n}\n\n#info > .text {\n  font-weight: bold;\n}\n\n.left {\n  font-size: 1.1em;\n  float: left;\n}\n\n.right {\n  font-size: 1em;\n  float: right;\n}\n\n#gameOver {\n  font-size: 1.5em;\n  font-weight: bolder;\n  text-align: center;\n}\n\n#gameRestart {\n  font-size: 0.8em;\n  font-weight: bolder;\n  text-align: center;\n}\n",""]);const a=s},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,r,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(o)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var u=0;u<e.length;u++){var l=[].concat(e[u]);o&&s[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),r&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=r):l[4]="".concat(r)),t.push(l))}},t}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var i={},s=[],a=0;a<e.length;a++){var c=e[a],u=o.base?c[0]+o.base:c[0],l=i[u]||0,b="".concat(u," ").concat(l);i[u]=l+1;var f=n(b),h={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)t[f].references++,t[f].updater(h);else{var p=r(h,o);o.byIndex=a,t.splice(a,0,{identifier:b,updater:p,references:1})}s.push(b)}return s}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var i=o(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var a=n(i[s]);t[a].references--}for(var c=o(e,r),u=0;u<i.length;u++){var l=n(i[u]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=c}}},569:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,r&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={id:o,exports:{}};return e[o](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var o={};(()=>{n.d(o,{gO:()=>st,gT:()=>it,HS:()=>at,l_:()=>rt,KC:()=>ct});var e=n(379),t=n.n(e),r=n(795),i=n.n(r),s=n(569),a=n.n(s),c=n(565),u=n.n(c),l=n(216),b=n.n(l),f=n(589),h=n.n(f),p=n(426),d={};d.styleTagTransform=h(),d.setAttributes=u(),d.insert=a().bind(null,"head"),d.domAPI=i(),d.insertStyleElement=b(),t()(p.Z,d),p.Z&&p.Z.locals&&p.Z.locals;var v=function(e,t){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},v(e,t)};function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function m(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}function O(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function D(e){return this instanceof D?(this.v=e,this):new D(e)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var H=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function j(e){return"function"==typeof e}function x(e){return j(null==e?void 0:e.then)}var T,w=((T=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),T.prototype.constructor=T,T);function S(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var C=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,o,r;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var s=y(i),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(j(c))try{c()}catch(e){r=e instanceof w?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var l=y(u),b=l.next();!b.done;b=l.next()){var f=b.value;try{_(f)}catch(e){r=null!=r?r:[],e instanceof w?r=O(O([],I(r)),I(e.errors)):r.push(e)}}}catch(e){n={error:e}}finally{try{b&&!b.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}}if(r)throw new w(r)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)_(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&S(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&S(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}();function E(e){return e instanceof C||e&&"closed"in e&&j(e.remove)&&j(e.add)&&j(e.unsubscribe)}function _(e){j(e)?e():e.unsubscribe()}C.EMPTY;var A={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},G={setTimeout:function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var r=G.delegate;return(null==r?void 0:r.setTimeout)?r.setTimeout.apply(r,O([e,t],I(n))):setTimeout.apply(void 0,O([e,t],I(n)))},clearTimeout:function(e){var t=G.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function P(e){G.setTimeout((function(){var t=A.onUnhandledError;if(!t)throw e;t(e)}))}function W(){}var R=L("C",void 0,void 0);function L(e,t,n){return{kind:e,value:t,error:n}}var N=null,k=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,E(t)&&t.add(n)):n.destination=q,n}return g(t,e),t.create=function(e,t,n){return new K(e,t,n)},t.prototype.next=function(e){this.isStopped?z(function(e){return L("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?z(L("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?z(R,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(C),M=Function.prototype.bind;function B(e,t){return M.call(e,t)}var V=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){U(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){U(e)}else U(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){U(e)}},e}(),K=function(e){function t(t,n,o){var r,i,s=e.call(this)||this;return j(t)||!t?r={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=o?o:void 0}:s&&A.useDeprecatedNextContext?((i=Object.create(t)).unsubscribe=function(){return s.unsubscribe()},r={next:t.next&&B(t.next,i),error:t.error&&B(t.error,i),complete:t.complete&&B(t.complete,i)}):r=t,s.destination=new V(r),s}return g(t,e),t}(k);function U(e){var t;A.useDeprecatedSynchronousErrorHandling?(t=e,A.useDeprecatedSynchronousErrorHandling&&N&&(N.errorThrown=!0,N.error=t)):P(e)}function z(e,t){var n=A.onStoppedNotification;n&&G.setTimeout((function(){return n(e,t)}))}var q={closed:!0,next:W,error:function(e){throw e},complete:W},$="function"==typeof Symbol&&Symbol.observable||"@@observable";function F(e){return e}var Y=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var o,r=this,i=(o=e)&&o instanceof k||function(e){return e&&j(e.next)&&j(e.error)&&j(e.complete)}(o)&&E(o)?e:new K(e,t,n);return function(e){if(A.useDeprecatedSynchronousErrorHandling){var t=!N;if(t&&(N={errorThrown:!1,error:null}),e(),t){var n=N,o=n.errorThrown,r=n.error;if(N=null,o)throw r}}else e()}((function(){var e=r,t=e.operator,n=e.source;i.add(t?t.call(i,n):n?r._subscribe(i):r._trySubscribe(i))})),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Z(t))((function(t,o){var r=new K({next:function(t){try{e(t)}catch(e){o(e),r.unsubscribe()}},error:o,complete:t});n.subscribe(r)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[$]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?F:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=Z(e))((function(e,n){var o;t.subscribe((function(e){return o=e}),(function(e){return n(e)}),(function(){return e(o)}))}))},e.create=function(t){return new e(t)},e}();function Z(e){var t;return null!==(t=null!=e?e:A.Promise)&&void 0!==t?t:Promise}function Q(e){return j(e[$])}function J(e){return Symbol.asyncIterator&&j(null==e?void 0:e[Symbol.asyncIterator])}function X(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var ee="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function te(e){return j(null==e?void 0:e[ee])}function ne(e){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),i=[];return o={},s("next"),s("throw"),s("return"),o[Symbol.asyncIterator]=function(){return this},o;function s(e){r[e]&&(o[e]=function(t){return new Promise((function(n,o){i.push([e,t,n,o])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof D?Promise.resolve(n.value.v).then(c,u):l(i[0][2],n)}catch(e){l(i[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}(this,arguments,(function(){var t,n,o;return m(this,(function(r){switch(r.label){case 0:t=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,D(t.read())];case 3:return n=r.sent(),o=n.value,n.done?[4,D(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,D(o)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function oe(e){return j(null==e?void 0:e.getReader)}function re(e){if(e instanceof Y)return e;if(null!=e){if(Q(e))return r=e,new Y((function(e){var t=r[$]();if(j(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(H(e))return o=e,new Y((function(e){for(var t=0;t<o.length&&!e.closed;t++)e.next(o[t]);e.complete()}));if(x(e))return n=e,new Y((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,P)}));if(J(e))return ie(e);if(te(e))return t=e,new Y((function(e){var n,o;try{for(var r=y(t),i=r.next();!i.done;i=r.next()){var s=i.value;if(e.next(s),e.closed)return}}catch(e){n={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}e.complete()}));if(oe(e))return ie(ne(e))}var t,n,o,r;throw X(e)}function ie(e){return new Y((function(t){(function(e,t){var n,o,r,i,s,a,c,u;return s=this,a=void 0,u=function(){var s,a;return m(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=y(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}(e),c.label=1;case 1:return[4,n.next()];case 2:if((o=c.sent()).done)return[3,4];if(s=o.value,t.next(s),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),r={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),o&&!o.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{r(u.next(e))}catch(e){t(e)}}function o(e){try{r(u.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof c?r:new c((function(e){e(r)}))).then(n,o)}r((u=u.apply(s,a||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function se(e){return function(t){if(function(e){return j(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function ae(e,t,n,o,r){return new ce(e,t,n,o,r)}var ce=function(e){function t(t,n,o,r,i,s){var a=e.call(this,t)||this;return a.onFinalize=i,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=r?function(e){try{r(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=o?function(){try{o()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return g(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(k);function ue(e,t){return se((function(n,o){var r=0;n.subscribe(ae(o,(function(n){o.next(e.call(t,n,r++))})))}))}function le(e,t,n,o,r){void 0===o&&(o=0),void 0===r&&(r=!1);var i=t.schedule((function(){n(),r?e.add(this.schedule(null,o)):this.unsubscribe()}),o);if(e.add(i),!r)return i}function be(e,t,n){return void 0===n&&(n=1/0),j(t)?be((function(n,o){return ue((function(e,r){return t(n,e,o,r)}))(re(e(n,o)))}),n):("number"==typeof t&&(n=t),se((function(t,o){return function(e,t,n,o,r,i,s,a){var c=[],u=0,l=0,b=!1,f=function(){!b||c.length||u||t.complete()},h=function(e){return u<o?p(e):c.push(e)},p=function(e){u++;var r=!1;re(n(e,l++)).subscribe(ae(t,(function(e){t.next(e)}),(function(){r=!0}),void 0,(function(){if(r)try{u--;for(;c.length&&u<o;)e=void 0,e=c.shift(),p(e);f()}catch(e){t.error(e)}var e})))};return e.subscribe(ae(t,h,(function(){b=!0,f()}))),function(){}}(t,o,e,n)})))}var fe=Array.isArray;var he=["addListener","removeListener"],pe=["addEventListener","removeEventListener"],de=["on","off"];function ve(e,t,n,o){if(j(n)&&(o=n,n=void 0),o)return ve(e,t,n).pipe((r=o,ue((function(e){return function(e,t){return fe(t)?e.apply(void 0,O([],I(t))):e(t)}(r,e)}))));var r,i=I(function(e){return j(e.addEventListener)&&j(e.removeEventListener)}(e)?pe.map((function(o){return function(r){return e[o](t,r,n)}})):function(e){return j(e.addListener)&&j(e.removeListener)}(e)?he.map(ge(e,t)):function(e){return j(e.on)&&j(e.off)}(e)?de.map(ge(e,t)):[],2),s=i[0],a=i[1];if(!s&&H(e))return be((function(e){return ve(e,t,n)}))(re(e));if(!s)throw new TypeError("Invalid event target");return new Y((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return s(t),function(){return a(t)}}))}function ge(e,t){return function(n){return function(o){return e[n](t,o)}}}var me=function(e){function t(t,n){return e.call(this)||this}return g(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(C),ye={setInterval:function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var r=ye.delegate;return(null==r?void 0:r.setInterval)?r.setInterval.apply(r,O([e,t],I(n))):setInterval.apply(void 0,O([e,t],I(n)))},clearInterval:function(e){var t=ye.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},Ie=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.scheduler=t,o.work=n,o.pending=!1,o}return g(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var o=this.id,r=this.scheduler;return null!=o&&(this.id=this.recycleAsyncId(r,o,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),ye.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&ye.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,o=!1;try{this.work(e)}catch(e){o=!0,n=e||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,o=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,S(o,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(me),Oe={now:function(){return(Oe.delegate||Date).now()},delegate:void 0},De=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=Oe.now,e}(),He=new(function(e){function t(t,n){void 0===n&&(n=De.now);var o=e.call(this,t,n)||this;return o.actions=[],o._active=!1,o}return g(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(De))(Ie),je=He;function xe(e){return e&&j(e.schedule)}function Te(e,t){return void 0===e&&(e=0),void 0===t&&(t=He),e<0&&(e=0),function(e,t,n){void 0===e&&(e=0),void 0===n&&(n=je);var o=-1;return null!=t&&(xe(t)?n=t:o=t),new Y((function(t){var r,i=(r=e)instanceof Date&&!isNaN(r)?+e-n.now():e;i<0&&(i=0);var s=0;return n.schedule((function(){t.closed||(t.next(s++),0<=o?this.schedule(void 0,o):t.complete())}),i)}))}(e,e,t)}var we=new Y((function(e){return e.complete()}));function Se(e){return e[e.length-1]}function Ce(e,t){return void 0===t&&(t=0),se((function(n,o){n.subscribe(ae(o,(function(n){return le(o,e,(function(){return o.next(n)}),t)}),(function(){return le(o,e,(function(){return o.complete()}),t)}),(function(n){return le(o,e,(function(){return o.error(n)}),t)})))}))}function Ee(e,t){return void 0===t&&(t=0),se((function(n,o){o.add(e.schedule((function(){return n.subscribe(o)}),t))}))}function _e(e,t){if(!e)throw new Error("Iterable cannot be null");return new Y((function(n){le(n,t,(function(){var o=e[Symbol.asyncIterator]();le(n,t,(function(){o.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function Ae(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(e){return xe(Se(e))?e.pop():void 0}(e),o=function(e,t){return"number"==typeof Se(e)?e.pop():1/0}(e),r=e;return r.length?1===r.length?re(r[0]):function(e){return void 0===e&&(e=1/0),be(F,e)}(o)(function(e,t){return t?function(e,t){if(null!=e){if(Q(e))return function(e,t){return re(e).pipe(Ee(t),Ce(t))}(e,t);if(H(e))return function(e,t){return new Y((function(n){var o=0;return t.schedule((function(){o===e.length?n.complete():(n.next(e[o++]),n.closed||this.schedule())}))}))}(e,t);if(x(e))return function(e,t){return re(e).pipe(Ee(t),Ce(t))}(e,t);if(J(e))return _e(e,t);if(te(e))return function(e,t){return new Y((function(n){var o;return le(n,t,(function(){o=e[ee](),le(n,t,(function(){var e,t,r;try{t=(e=o.next()).value,r=e.done}catch(e){return void n.error(e)}r?n.complete():n.next(t)}),0,!0)})),function(){return j(null==o?void 0:o.return)&&o.return()}}))}(e,t);if(oe(e))return function(e,t){return _e(ne(e),t)}(e,t)}throw X(e)}(e,t):re(e)}(r,n)):we}function Ge(e,t){return se(function(e,t,n,o,r){return function(o,r){var i=n,s=t,a=0;o.subscribe(ae(r,(function(t){var n=a++;s=i?e(s,t,n):(i=!0,t),r.next(s)}),undefined))}}(e,t,arguments.length>=2))}class Pe{}function We(e){return function(t=0){return e.pipe(Ge((e=>Pe.hash(e)),t),ue(Pe.scale))}}Object.defineProperty(Pe,"m",{enumerable:!0,configurable:!0,writable:!0,value:2147483648}),Object.defineProperty(Pe,"a",{enumerable:!0,configurable:!0,writable:!0,value:1103515245}),Object.defineProperty(Pe,"c",{enumerable:!0,configurable:!0,writable:!0,value:12345}),Object.defineProperty(Pe,"hash",{enumerable:!0,configurable:!0,writable:!0,value:e=>(Pe.a*e+Pe.c)%Pe.m}),Object.defineProperty(Pe,"scale",{enumerable:!0,configurable:!0,writable:!0,value:e=>Math.floor(e/Pe.m*4+1)-1});const Re=(e,t)=>new[Ze,Qe,Je,Xe][e](t),Le=e=>["red","green","blue","yellow"][e],Ne=(e,t,n)=>{var o;return Pe.scale(Pe.hash(t)+Pe.hash(n))<1?Pe.scale(Pe.hash(Pe.scale(Pe.hash(t)+Pe.hash(n))))<2&&(null===(o=e.scoreAndDropRate)||void 0===o?void 0:o.gameLevel)>3?{currentBlock:Re(t,n),nextBlock:new nt}:{currentBlock:Re(t,n),nextBlock:new tt}:{currentBlock:Re(t,n),nextBlock:Re(t,n)}},ke=(e,t=!1,n=0)=>{var o,r,i,s;const a=t?(null===(o=e.scoreAndDropRate)||void 0===o?void 0:o.gameScore)+100*n:(null===(r=e.scoreAndDropRate)||void 0===r?void 0:r.gameScore)+10,c=Math.floor(a/1e3)+1,u=a>(null===(i=e.scoreAndDropRate)||void 0===i?void 0:i.gameHighScore)?a:null===(s=e.scoreAndDropRate)||void 0===s?void 0:s.gameHighScore;if(c>1&&c<=10){const t=e.oldGameCubes.map(((e,t)=>{return t>=it.GRID_HEIGHT-(c-1)?(n=t,Array.from({length:it.GRID_WIDTH}).map(((e,t)=>({color:"gray",shape:at.BEDROCK,position:{x:t*st.WIDTH,y:rt.CANVAS_HEIGHT-(it.GRID_HEIGHT-n)*st.HEIGHT},rotationID:0})))):e;var n}));return Object.assign(Object.assign({},e),{scoreAndDropRate:Object.assign(Object.assign({},e.scoreAndDropRate),{gameScore:a,gameHighScore:u,gameLevel:c}),oldGameCubes:t})}return Object.assign(Object.assign({},e),{scoreAndDropRate:Object.assign(Object.assign({},e.scoreAndDropRate),{gameScore:a,gameHighScore:u,gameLevel:c})})},Me=(e,t,n,o)=>e.map(((e,r)=>r===t?e.map(((e,t)=>t===n?o:e)):e)),Be=(e,t,n)=>"x"===t&&n<0?e.every((e=>e.position.x+n>=0)):"x"===t&&n>0?e.every((e=>e.position.x+n<=rt.CANVAS_WIDTH-st.WIDTH)):e.every((e=>e.position.y+n<=rt.CANVAS_HEIGHT-st.HEIGHT)),Ve=(e,t,n)=>"l"===n?!!e.oldGameCubes[Math.floor(t.position.y/st.HEIGHT)][Math.floor(t.position.x/st.WIDTH)-1]:"r"===n?!!e.oldGameCubes[Math.floor(t.position.y/st.HEIGHT)][Math.floor(t.position.x/st.WIDTH)+1]:!!e.oldGameCubes[Math.floor(t.position.y/st.HEIGHT)+1][Math.floor(t.position.x/st.WIDTH)],Ke=(e,t)=>{const n=e.cubes.map((e=>Object.assign(Object.assign({},e),{position:{x:Math.floor(e.position.x/st.WIDTH)*st.WIDTH,y:e.position.y}})));return e.cubes=n,Object.assign(Object.assign({},t),{currentGameCube:e})},Ue=(e,t,n)=>{const o=e.cubes.map((e=>Object.assign(Object.assign({},e),{position:{x:e.position.x+n,y:e.position.y}})));return e.cubes=o,Object.assign(Object.assign({},t),{currentGameCube:e})},ze=(e,t)=>{const n=e.cubes.map((e=>Object.assign(Object.assign({},e),{position:{x:Math.floor(e.position.x/st.WIDTH)*st.WIDTH,y:e.position.y}})));return e.cubes=n,Object.assign(Object.assign({},t),{currentGameCube:e})},qe=(e,t,n)=>{const o=e.cubes.map((e=>Object.assign(Object.assign({},e),{position:{x:e.position.x+n,y:e.position.y}})));return e.cubes=o,Object.assign(Object.assign({},t),{currentGameCube:e})},$e=(e,t)=>{const n=e.cubes.map((e=>Object.assign(Object.assign({},e),{position:{x:e.position.x,y:Math.floor(e.position.y/st.HEIGHT)*st.HEIGHT}})));return e.cubes=n,Object.assign(Object.assign({},t),{currentGameCube:e})},Fe=(e,t,n)=>{const o=e.cubes.map((e=>Object.assign(Object.assign({},e),{position:{x:e.position.x,y:e.position.y+n}})));return e.cubes=o,Object.assign(Object.assign({},t),{currentGameCube:e})};class Ye{constructor(){Object.defineProperty(this,"cubes",{enumerable:!0,configurable:!0,writable:!0,value:new Array(it.CUBE_NUMBERS).fill(null)}),Object.defineProperty(this,"rotationLevel",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"moveHelper",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,n,o,r,i,s,a)=>Be(e.cubes,o,n)?e.cubes.some((e=>i(t,e,r)))?s(e,t):a(e,t,n):t}),Object.defineProperty(this,"checkContinueMove",{enumerable:!0,configurable:!0,writable:!0,value:e=>!!Be(this.cubes,"y",st.HEIGHT)&&!this.checkContinueDown(e,this.cubes)}),Object.defineProperty(this,"updatePositions",{enumerable:!0,configurable:!0,writable:!0,value:e=>this.moveDown(e,st.HEIGHT)}),Object.defineProperty(this,"updateOldGameCubes",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=this.updateOldGameCubesRec(0,e.oldGameCubes);return Object.assign(Object.assign({},e),{oldGameCubes:t})}}),Object.defineProperty(this,"updateOldGameCubesRec",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{if(e>=this.cubes.length)return t;const n=this.cubes.find((t=>t.rotationID===e));if(n){const o=Me(t,Math.floor(n.position.y/st.HEIGHT),Math.floor(n.position.x/st.WIDTH),n);return this.updateOldGameCubesRec(e+1,o)}return this.updateOldGameCubesRec(e+1,t)}})}}class Ze extends Ye{constructor(e){super(),Object.defineProperty(this,"moveLeft",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>Be(this.cubes,"x",t)?this.cubes.some((t=>(0===t.rotationID||2===t.rotationID)&&Ve(e,t,"l")))?Ke(this,e):Ue(this,e,t):e}),Object.defineProperty(this,"moveRight",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>Be(this.cubes,"x",t)?this.cubes.some((t=>(1===t.rotationID||3===t.rotationID)&&Ve(e,t,"r")))?ze(this,e):qe(this,e,t):e}),Object.defineProperty(this,"moveDown",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>Be(this.cubes,"y",t)?this.checkContinueDown(e,this.cubes)?$e(this,e):Fe(this,e,t):e}),Object.defineProperty(this,"rotate",{enumerable:!0,configurable:!0,writable:!0,value:e=>e}),Object.defineProperty(this,"checkContinueDown",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>t.some((t=>(2===t.rotationID||3===t.rotationID)&&Ve(e,t,"d")))});const t={color:Le(e),shape:at.SQUARE_BLOCK,position:ct.POSITION_1,rotationID:0};this.cubes=[t,Object.assign(Object.assign({},t),{position:ct.POSITION_2,rotationID:1}),Object.assign(Object.assign({},t),{position:ct.POSITION_5,rotationID:2}),Object.assign(Object.assign({},t),{position:ct.POSITION_6,rotationID:3})]}}class Qe extends Ye{constructor(e){super(),Object.defineProperty(this,"rotationLevel",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"moveRight",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{return this.moveHelper(this,e,t,"x","r",(n=this.rotationLevel,function(e,t,o){return(0===n&&(3===t.rotationID||0===t.rotationID)||2===n&&(1===t.rotationID||0===t.rotationID)||3===n&&(0===t.rotationID||1===t.rotationID||3===t.rotationID)||1===n&&(1===t.rotationID||2===t.rotationID||3===t.rotationID))&&Ve(e,t,o)}),ze,qe);var n}}),Object.defineProperty(this,"moveDown",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>Be(this.cubes,"y",t)?this.checkContinueDown(e,this.cubes)?$e(this,e):Fe(this,e,t):e}),Object.defineProperty(this,"rotate",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=this.cubes.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.rotationID]:t.position})),{});if(0===this.rotationLevel){const n=this.cubes.find((e=>2===e.rotationID));if(!n||Ve(e,n,"d"))return e;{const e=this.cubes.map((e=>0===e.rotationID?Object.assign(Object.assign({},e),{position:t[1]}):1===e.rotationID?Object.assign(Object.assign({},e),{position:Object.assign(Object.assign({},t[2]),{y:t[2].y+st.HEIGHT})}):2===e.rotationID?e:Object.assign(Object.assign({},e),{position:t[0]})));this.cubes=e,this.rotationLevel=1}}else if(1===this.rotationLevel){const n=this.cubes.find((e=>2===e.rotationID));if(!n||n.position.x===rt.CANVAS_WIDTH-st.WIDTH||Ve(e,n,"r"))return e;{const e=this.cubes.map((e=>0===e.rotationID?Object.assign(Object.assign({},e),{position:t[1]}):1===e.rotationID?Object.assign(Object.assign({},e),{position:Object.assign(Object.assign({},t[2]),{x:t[2].x+st.WIDTH})}):2===e.rotationID?e:Object.assign(Object.assign({},e),{position:t[0]})));this.cubes=e,this.rotationLevel=2}}else if(2===this.rotationLevel){const n=this.cubes.find((e=>2===e.rotationID));if(!n||e.oldGameCubes[Math.floor(n.position.y/st.HEIGHT)-1][Math.floor(n.position.x/st.WIDTH)])return e;{const e=this.cubes.map((e=>0===e.rotationID?Object.assign(Object.assign({},e),{position:t[1]}):1===e.rotationID?Object.assign(Object.assign({},e),{position:Object.assign(Object.assign({},t[2]),{y:t[2].y-st.HEIGHT})}):2===e.rotationID?e:Object.assign(Object.assign({},e),{position:t[0]})));this.cubes=e,this.rotationLevel=3}}else if(3===this.rotationLevel){const n=this.cubes.find((e=>2===e.rotationID));if(!n||0===n.position.x||Ve(e,n,"l"))return e;{const e=this.cubes.map((e=>0===e.rotationID?Object.assign(Object.assign({},e),{position:t[1]}):1===e.rotationID?Object.assign(Object.assign({},e),{position:Object.assign(Object.assign({},t[2]),{x:t[2].x-st.WIDTH})}):2===e.rotationID?e:Object.assign(Object.assign({},e),{position:t[0]})));this.cubes=e,this.rotationLevel=0}}return e}}),Object.defineProperty(this,"checkContinueDown",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>t.some((t=>(1===this.rotationLevel&&(1===t.rotationID||0===t.rotationID)||2===this.rotationLevel&&(0===t.rotationID||1===t.rotationID||3===t.rotationID)||3===this.rotationLevel&&(3===t.rotationID||0===t.rotationID)||0===this.rotationLevel&&(1===t.rotationID||2===t.rotationID||3===t.rotationID))&&Ve(e,t,"d")))});const t={color:Le(e),shape:at.RAISED_BLOCK,position:ct.POSITION_1,rotationID:0};this.cubes=[t,Object.assign(Object.assign({},t),{position:ct.POSITION_4,rotationID:1}),Object.assign(Object.assign({},t),{position:ct.POSITION_5,rotationID:2}),Object.assign(Object.assign({},t),{position:ct.POSITION_6,rotationID:3})]}moveLeft(e,t){return this.moveHelper(this,e,t,"x","l",(n=this.rotationLevel,function(e,t,o){return(0===n&&(1===t.rotationID||0===t.rotationID)||1===n&&(0===t.rotationID||3===t.rotationID||1===t.rotationID)||2===n&&(3===t.rotationID||0===t.rotationID)||3===n&&(1===t.rotationID||2===t.rotationID||3===t.rotationID))&&Ve(e,t,o)}),Ke,Ue);var n}}class Je extends Ye{constructor(e){super(),Object.defineProperty(this,"rotationLevel",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"moveLeft",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{return this.moveHelper(this,e,t,"x","l",(n=this.rotationLevel,function(e,t,o){return(0===n&&(2===t.rotationID||0===t.rotationID)||1===n&&(0===t.rotationID||3===t.rotationID||1===t.rotationID)||2===n&&(3===t.rotationID||1===t.rotationID)||3===n&&(0===t.rotationID||2===t.rotationID||3===t.rotationID))&&Ve(e,t,o)}),Ke,Ue);var n}}),Object.defineProperty(this,"moveRight",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{return this.moveHelper(this,e,t,"x","r",(n=this.rotationLevel,function(e,t,o){return(0===n&&(3===t.rotationID||1===t.rotationID)||2===n&&(2===t.rotationID||0===t.rotationID)||3===n&&(0===t.rotationID||1===t.rotationID||3===t.rotationID)||1===n&&(0===t.rotationID||2===t.rotationID||3===t.rotationID))&&Ve(e,t,o)}),ze,qe);var n}}),Object.defineProperty(this,"moveDown",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>Be(this.cubes,"y",t)?this.checkContinueDown(e,this.cubes)?$e(this,e):Fe(this,e,t):e}),Object.defineProperty(this,"rotate",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=this.cubes.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.rotationID]:t.position})),{});if(0===this.rotationLevel){const n=this.cubes.find((e=>2===e.rotationID));if(!n||Ve(e,n,"l")||e.oldGameCubes[Math.floor(n.position.y/st.HEIGHT)+1][Math.floor(n.position.x/st.WIDTH)-1])return e;{const e=this.cubes.map((e=>0===e.rotationID?Object.assign(Object.assign({},e),{position:{x:t[2].x-st.WIDTH,y:t[2].y+st.HEIGHT}}):1===e.rotationID?Object.assign(Object.assign({},e),{position:Object.assign(Object.assign({},t[2]),{x:t[2].x-st.WIDTH})}):2===e.rotationID?e:Object.assign(Object.assign({},e),{position:t[1]})));this.cubes=e,this.rotationLevel=1}}else if(1===this.rotationLevel){const n=this.cubes.find((e=>2===e.rotationID));if(!n||n.position.x===rt.CANVAS_WIDTH-st.WIDTH||Ve(e,n,"d")||e.oldGameCubes[Math.floor(n.position.y/st.HEIGHT)+1][Math.floor(n.position.x/st.WIDTH)+1])return e;{const e=this.cubes.map((e=>0===e.rotationID?Object.assign(Object.assign({},e),{position:{x:t[2].x+st.WIDTH,y:t[2].y+st.HEIGHT}}):1===e.rotationID?Object.assign(Object.assign({},e),{position:Object.assign(Object.assign({},t[2]),{y:t[2].y+st.HEIGHT})}):2===e.rotationID?e:Object.assign(Object.assign({},e),{position:t[1]})));this.cubes=e,this.rotationLevel=2}}else if(2===this.rotationLevel){const n=this.cubes.find((e=>2===e.rotationID));if(!n||Ve(e,n,"r")||e.oldGameCubes[Math.floor(n.position.y/st.HEIGHT)-1][Math.floor(n.position.x/st.WIDTH)+1])return e;{const e=this.cubes.map((e=>0===e.rotationID?Object.assign(Object.assign({},e),{position:{x:t[2].x+st.WIDTH,y:t[2].y-st.HEIGHT}}):1===e.rotationID?Object.assign(Object.assign({},e),{position:Object.assign(Object.assign({},t[2]),{x:t[2].x+st.WIDTH})}):2===e.rotationID?e:Object.assign(Object.assign({},e),{position:t[1]})));this.cubes=e,this.rotationLevel=3}}else if(3===this.rotationLevel){const n=this.cubes.find((e=>2===e.rotationID));if(!n||0===n.position.x||e.oldGameCubes[Math.floor(n.position.y/st.HEIGHT)-1][Math.floor(n.position.x/st.WIDTH)]||e.oldGameCubes[Math.floor(n.position.y/st.HEIGHT)-1][Math.floor(n.position.x/st.WIDTH)-1])return e;{const e=this.cubes.map((e=>0===e.rotationID?Object.assign(Object.assign({},e),{position:{x:t[2].x-st.WIDTH,y:t[2].y-st.HEIGHT}}):1===e.rotationID?Object.assign(Object.assign({},e),{position:Object.assign(Object.assign({},t[2]),{y:t[2].y-st.HEIGHT})}):2===e.rotationID?e:Object.assign(Object.assign({},e),{position:t[1]})));this.cubes=e,this.rotationLevel=0}}return e}}),Object.defineProperty(this,"checkContinueDown",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>t.some((t=>(1===this.rotationLevel&&(2===t.rotationID||0===t.rotationID)||2===this.rotationLevel&&(0===t.rotationID||1===t.rotationID||3===t.rotationID)||3===this.rotationLevel&&(3===t.rotationID||1===t.rotationID)||0===this.rotationLevel&&(0===t.rotationID||2===t.rotationID||3===t.rotationID))&&Ve(e,t,"d")))});const t={color:Le(e),shape:at.LIGHTNING_BLOCK,position:ct.POSITION_1,rotationID:0};this.cubes=[t,Object.assign(Object.assign({},t),{position:ct.POSITION_2,rotationID:1}),Object.assign(Object.assign({},t),{position:ct.POSITION_6,rotationID:2}),Object.assign(Object.assign({},t),{position:ct.POSITION_7,rotationID:3})]}}class Xe extends Ye{constructor(e){super(),Object.defineProperty(this,"rotationLevel",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"moveLeft",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{return this.moveHelper(this,e,t,"x","l",(n=this.rotationLevel,function(e,t,o){return(0===n&&0===t.rotationID||1===n&&(0===t.rotationID||1===t.rotationID||2===t.rotationID||3===t.rotationID))&&Ve(e,t,o)}),Ke,Ue);var n}}),Object.defineProperty(this,"moveRight",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{return this.moveHelper(this,e,t,"x","r",(n=this.rotationLevel,function(e,t,o){return(0===n&&3===t.rotationID||1===n&&(0===t.rotationID||1===t.rotationID||2===t.rotationID||3===t.rotationID))&&Ve(e,t,o)}),ze,qe);var n}}),Object.defineProperty(this,"moveDown",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>Be(this.cubes,"y",t)?this.checkContinueDown(e,this.cubes)?$e(this,e):Fe(this,e,t):e}),Object.defineProperty(this,"rotate",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=this.cubes.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.rotationID]:t.position})),{});if(0===this.rotationLevel){const n=this.cubes.find((e=>2===e.rotationID));if(!(n&&n.position.y<rt.CANVAS_HEIGHT-st.HEIGHT&&n.position.y>=2*st.HEIGHT)||e.oldGameCubes[Math.floor(n.position.y/st.HEIGHT)-1][Math.floor(n.position.x/st.WIDTH)]||e.oldGameCubes[Math.floor(n.position.y/st.HEIGHT)-2][Math.floor(n.position.x/st.WIDTH)]||Ve(e,n,"d"))return e;{const e=this.cubes.map((e=>0===e.rotationID?Object.assign(Object.assign({},e),{position:{x:t[2].x,y:t[2].y-2*st.HEIGHT}}):1===e.rotationID?Object.assign(Object.assign({},e),{position:{x:t[2].x,y:t[2].y-st.HEIGHT}}):2===e.rotationID?e:Object.assign(Object.assign({},e),{position:{x:t[2].x,y:t[2].y+st.HEIGHT}})));this.cubes=e,this.rotationLevel=1}}else if(1===this.rotationLevel){const n=this.cubes.find((e=>2===e.rotationID));if(!(n&&n.position.x>=2*st.WIDTH&&n.position.x<rt.CANVAS_WIDTH-st.WIDTH)||e.oldGameCubes[Math.floor(n.position.y/st.HEIGHT)][Math.floor(n.position.x/st.WIDTH)-2]||Ve(e,n,"l")||Ve(e,n,"r"))return e;{const e=this.cubes.map((e=>0===e.rotationID?Object.assign(Object.assign({},e),{position:{x:t[2].x-2*st.WIDTH,y:t[2].y}}):1===e.rotationID?Object.assign(Object.assign({},e),{position:{x:t[2].x-st.WIDTH,y:t[2].y}}):2===e.rotationID?e:Object.assign(Object.assign({},e),{position:{x:t[2].x+st.WIDTH,y:t[2].y}})));this.cubes=e,this.rotationLevel=0}}return e}}),Object.defineProperty(this,"checkContinueDown",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>t.some((t=>(1===this.rotationLevel&&3===t.rotationID||0===this.rotationLevel&&(0===t.rotationID||1===t.rotationID||2===t.rotationID||3===t.rotationID))&&Ve(e,t,"d")))});const t={color:Le(e),shape:at.LINE_BLOCK,position:ct.POSITION_0,rotationID:0};this.cubes=[t,Object.assign(Object.assign({},t),{position:ct.POSITION_1,rotationID:1}),Object.assign(Object.assign({},t),{position:ct.POSITION_2,rotationID:2}),Object.assign(Object.assign({},t),{position:ct.POSITION_3,rotationID:3})]}}class et extends Ye{constructor(e,t){super(),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"shape",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"moveLeft",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>Be(this.cubes,"x",t)?this.cubes.some((t=>Ve(e,t,"l")))?Ke(this,e):Ue(this,e,t):e}),Object.defineProperty(this,"moveRight",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>Be(this.cubes,"x",t)?this.cubes.some((t=>Ve(e,t,"r")))?ze(this,e):qe(this,e,t):e}),Object.defineProperty(this,"moveDown",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>Be(this.cubes,"y",t)?this.checkContinueDown(e,this.cubes)?$e(this,e):Fe(this,e,t):e}),Object.defineProperty(this,"rotate",{enumerable:!0,configurable:!0,writable:!0,value:e=>e}),Object.defineProperty(this,"checkContinueDown",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>t.some((t=>Ve(e,t,"d")))});const n={color:e,shape:t,position:ct.POSITION_1,rotationID:0};this.cubes=[n]}}class tt extends et{constructor(){super("white",at.STAR)}}class nt extends et{constructor(){super("rgba(74, 64, 53, 0.7)",at.BOMB),Object.defineProperty(this,"updateOldGameCubes",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=this.cubes[0],n=this.getAdjacentPositions(t.position).reduce(((e,t)=>Me(e,Math.floor(t.y/st.HEIGHT),Math.floor(t.x/st.WIDTH),null)),e.oldGameCubes);return Object.assign(Object.assign({},e),{oldGameCubes:n})}}),Object.defineProperty(this,"getAdjacentPositions",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const{x:t,y:n}=e;return[{x:t,y:n-st.HEIGHT},{x:t,y:n+st.HEIGHT},{x:t-st.WIDTH,y:n},{x:t+st.WIDTH,y:n},{x:t,y:n}]}})}}const ot=(e,t=null)=>{if(e.oldGameCubes[0].some((e=>null!==e)))return Object.assign(Object.assign({},e),{gameEnd:!0});if(!e.currentGameCube||e.needToCreateCube){const{currentBlock:t,nextBlock:n}=Ne(e,e.shapeSeed,e.colorSeed);return Object.assign(Object.assign({},e),{currentGameCube:e.nextBlock||t,nextBlock:n,needToCreateCube:!1})}const n=e=>e.oldGameCubes.some((e=>e.every((e=>null!==e&&e.shape!==at.BEDROCK))))?(e=>{const t=e.oldGameCubes.map(((e,t)=>e.every((e=>null!==e&&e.shape!==at.BEDROCK))?t:-1)).filter((e=>-1!==e)),n=e.oldGameCubes.map(((e,n)=>t.includes(n)&&e.some((e=>null!==e&&e.shape===at.STAR))?n:-1)).filter((e=>-1!==e)),o=[...new Set(n.reduce(((e,t)=>0===t?[0,1,...e]:19===t?[18,19,...e]:[t-1,t,t+1,...e]),[]))],r=[...new Set([...t,...o])],i=e.oldGameCubes.map(((e,t)=>r.includes(t)?new Array(e.length).fill(null):e)),s=i.map(((e,t)=>t<=Math.max(...r)?t-r.length>=0?i[t-r.length].map((e=>e?Object.assign(Object.assign({},e),{position:Object.assign(Object.assign({},e.position),{y:e.position.y+r.length*st.HEIGHT})}):null)):new Array(e.length).fill(null):e));return ke(Object.assign(Object.assign({},e),{oldGameCubes:s}),!0,r.length)})(e):e;if(!e.currentGameCube.checkContinueMove(e)){const t=e.currentGameCube.updateOldGameCubes(e),{currentBlock:n,nextBlock:o}=Ne(e,e.shapeSeed,e.colorSeed);return t.oldGameCubes[0].some((e=>null!==e))?Object.assign(Object.assign({},ke(t)),{gameEnd:!0}):Object.assign(Object.assign({},ke(t)),{currentGameCube:e.nextBlock||n,nextBlock:o})}return null===t?n(e.currentGameCube.updatePositions(e)):"x"===t.axis&&t.amount<0?n(e.currentGameCube.moveLeft(e,t.amount)):"x"===t.axis&&t.amount>0?n(e.currentGameCube.moveRight(e,t.amount)):"y"===t.axis&&t.amount>0?n(e.currentGameCube.moveDown(e,t.amount)):"z"===t.axis?n(e.currentGameCube.rotate(e)):e},rt={CANVAS_WIDTH:200,CANVAS_HEIGHT:400,PREVIEW_WIDTH:160,PREVIEW_HEIGHT:80},it={TICK_RATE_MS:500,GRID_WIDTH:10,GRID_HEIGHT:20,CUBE_NUMBERS:4},st={WIDTH:rt.CANVAS_WIDTH/it.GRID_WIDTH,HEIGHT:rt.CANVAS_HEIGHT/it.GRID_HEIGHT},at={SQUARE_BLOCK:0,RAISED_BLOCK:1,LIGHTNING_BLOCK:2,LINE_BLOCK:3,BEDROCK:4,STAR:5,BOMB:6},ct={POSITION_0:{x:st.WIDTH*(Math.floor(rt.CANVAS_WIDTH/st.WIDTH/2)-2),y:0},POSITION_1:{x:st.WIDTH*(Math.floor(rt.CANVAS_WIDTH/st.WIDTH/2)-1),y:0},POSITION_2:{x:st.WIDTH*Math.floor(rt.CANVAS_WIDTH/st.WIDTH/2),y:0},POSITION_3:{x:st.WIDTH*(Math.floor(rt.CANVAS_WIDTH/st.WIDTH/2)+1),y:0},POSITION_4:{x:st.WIDTH*(Math.floor(rt.CANVAS_WIDTH/st.WIDTH/2)-2),y:st.HEIGHT},POSITION_5:{x:st.WIDTH*(Math.floor(rt.CANVAS_WIDTH/st.WIDTH/2)-1),y:st.HEIGHT},POSITION_6:{x:st.WIDTH*Math.floor(rt.CANVAS_WIDTH/st.WIDTH/2),y:st.HEIGHT},POSITION_7:{x:st.WIDTH*(Math.floor(rt.CANVAS_WIDTH/st.WIDTH/2)+1),y:st.HEIGHT}},ut={gameEnd:!1,needToCreateCube:!0,scoreAndDropRate:{gameLevel:1,gameScore:0,gameHighScore:0,dropRate:1},oldGameCubes:new Array(it.GRID_HEIGHT).fill(null).map((()=>new Array(it.GRID_WIDTH).fill(null))),shapeSeed:0,colorSeed:0},lt=e=>{e.setAttribute("visibility","visible"),e.parentNode.appendChild(e)},bt=e=>e.setAttribute("visibility","hidden"),ft=(e,t,n={})=>{const o=document.createElementNS(e,t);return Object.entries(n).forEach((([e,t])=>o.setAttribute(e,t))),o};function ht(){const e=document.querySelector("#svgCanvas"),t=document.querySelector("#svgPreview"),n=document.querySelector("#gameOver"),o=document.querySelector("#gameRestart"),r=(document.querySelector("#main"),document.querySelector("#instantReplay"));e.setAttribute("height",`${rt.CANVAS_HEIGHT}`),e.setAttribute("width",`${rt.CANVAS_WIDTH}`),t.setAttribute("height",`${rt.PREVIEW_HEIGHT}`),t.setAttribute("width",`${rt.PREVIEW_WIDTH}`);const i=document.querySelector("#levelText"),s=document.querySelector("#scoreText"),a=document.querySelector("#highScoreText"),c=ve(document,"keypress"),u=ve(document,"click").pipe(ue((()=>({type:"mouseClick"})))),l=ve(r,"click").pipe(ue((()=>({type:"instantReplay"})))),b=(e,t)=>{return c.pipe((n=({code:t})=>t===e,se((function(e,t){var o=0;e.subscribe(ae(t,(function(e){return n.call(undefined,e,o++)&&t.next(e)})))}))),ue((()=>t)));var n},f=b("KeyA",{axis:"x",amount:-st.WIDTH}),h=b("KeyD",{axis:"x",amount:st.WIDTH}),p=b("KeyS",{axis:"y",amount:st.HEIGHT}),d=b("KeyW",{axis:"z",amount:0}),v=We(Te(199))(3).pipe(ue((e=>({shapeSeed:e})))),g=We(Te(31))(7).pipe(ue((e=>({colorSeed:e})))),m=Te(it.TICK_RATE_MS),y=t=>{if(t){const n=ft(e.namespaceURI,"rect",{height:`${st.HEIGHT}`,width:`${st.WIDTH}`,x:`${t.position.x}`,y:`${t.position.y}`,style:`fill: ${t.color}`,class:"gameBlock"});e.appendChild(n)}};Ae(m,f,h,p,d,u,l,v,g).pipe(Ge(((e,t)=>{var n,o,r,i,s,a,c,u,l,b,f,h;return"number"==typeof t?ot(e):t&&"shapeSeed"in t&&t.shapeSeed?Object.assign(Object.assign({},e),{shapeSeed:t.shapeSeed}):t&&"colorSeed"in t&&t.colorSeed?Object.assign(Object.assign({},e),{colorSeed:t.colorSeed}):t&&"type"in t&&"mouseClick"===t.type?e.gameEnd?Object.assign(Object.assign({},ut),{scoreAndDropRate:Object.assign(Object.assign({},ut.scoreAndDropRate),{gameHighScore:(null===(n=e.scoreAndDropRate)||void 0===n?void 0:n.gameScore)>(null===(o=ut.scoreAndDropRate)||void 0===o?void 0:o.gameHighScore)&&(null===(r=e.scoreAndDropRate)||void 0===r?void 0:r.gameScore)>(null===(i=e.scoreAndDropRate)||void 0===i?void 0:i.gameHighScore)?null===(s=e.scoreAndDropRate)||void 0===s?void 0:s.gameScore:null===(a=e.scoreAndDropRate)||void 0===a?void 0:a.gameHighScore})}):e:t&&"type"in t&&"instantReplay"===t.type?Object.assign(Object.assign({},ut),{scoreAndDropRate:Object.assign(Object.assign({},ut.scoreAndDropRate),{gameHighScore:(null===(c=e.scoreAndDropRate)||void 0===c?void 0:c.gameScore)>(null===(u=ut.scoreAndDropRate)||void 0===u?void 0:u.gameHighScore)&&(null===(l=e.scoreAndDropRate)||void 0===l?void 0:l.gameScore)>(null===(b=e.scoreAndDropRate)||void 0===b?void 0:b.gameHighScore)?null===(f=e.scoreAndDropRate)||void 0===f?void 0:f.gameScore:null===(h=e.scoreAndDropRate)||void 0===h?void 0:h.gameHighScore})}):ot(e,t)}),ut)).subscribe((r=>{(n=>{var o,r,c;n.scoreAndDropRate&&(i.textContent=(null===(o=n.scoreAndDropRate.gameLevel)||void 0===o?void 0:o.toString())||"0",s.textContent=(null===(r=n.scoreAndDropRate.gameScore)||void 0===r?void 0:r.toString())||"0",a.textContent=(null===(c=n.scoreAndDropRate.gameHighScore)||void 0===c?void 0:c.toString())||"0"),e.querySelectorAll(".gameBlock").forEach((t=>e.removeChild(t))),t.querySelectorAll(".preGameBlock").forEach((e=>t.removeChild(e))),n.nextBlock&&n.nextBlock.cubes.forEach((e=>(e=>{if(e){const n=ft(t.namespaceURI,"rect",{height:`${st.HEIGHT}`,width:`${st.WIDTH}`,x:""+(e.position.x-st.WIDTH),y:`${e.position.y+st.HEIGHT}`,style:`fill: ${e.color}`,class:"preGameBlock"});t.appendChild(n)}})(e))),n.currentGameCube&&n.currentGameCube.cubes.forEach((e=>y(e))),n.oldGameCubes&&n.oldGameCubes.map((e=>e.map(y)))})(r),r.gameEnd?(lt(n),lt(o)):(bt(n),bt(o))}))}"undefined"!=typeof window&&(window.onload=()=>{ht()})})()})();